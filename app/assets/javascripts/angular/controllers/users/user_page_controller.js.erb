app.controller('UserCtrl', ['$scope', '$http', '$auth', '$location', function($scope, $http, $auth, $location){
  
  $scope.industry_selection = 'Select a Industry First';
  $scope.company_selection = 'Select a Industry First';
  $scope.query = {};
  //set route path for backend
  var url = "<% ENV['URL']%>" || "http://localhost:3000";
  //call the get request when this Angular route is run
  $http.get(url + '/biz_users').then(function(response){
    $scope.industries = response.data;
    console.log(response);
  }).catch(function(response){
    console.log(response);
  });

  //call the get request for all the services first
  $http.get(url + '/services').then(function(response){
    $scope.services = response.data;
    console.log(response.data);
  }).catch(function(response){
    console.log(response);
  });

  // create the get request for creating a session
  $scope.createSession = function(service){
    var service = _.where($scope.services, {service_name: service})
    var data    = {
      service_id: service[0].id,
      user_id:    $auth.validateUser().$$state.value.id
    };
    $http.post(url + '/sessions', data).then(function(response){
      console.log(response);
    }).catch(function(response){
      console.log(response);
    })

  };
}]);